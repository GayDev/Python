import os
import time
import colorsys
import time
import math
from sty import fg,bg,RgbFg
#=========================================================================================================================

def sign(n):
    if n<0:
        return -1
    elif n>0:
        return 1
    else:
        return 0

class frame:
    def __init__(self,strings):
        self.strings=strings
    
    def flip_vert(self):
        a=[]
        for i in range(0,len(self.strings)):
            a.append(self.strings[-1-i])
        return frame(a)

    def flip_hor(self):
        a=[]
        for i in range(0,len(self.strings)):
            a.append(self.strings[i][::-1])
        return frame(a)
#==========================================================================================================================
class loading:
    def __init__(self):
        self.frames=[]

    def add_frame(self,frame):
        self.frames.append(frame)

    def loop(self):
        for i in range(0,len(self.frames)-1):
            self.add_frame(self.frames[i+1].flip_hor().flip_vert())

    def drawPidr(self):
        for i in range(0,60):
            self.add_frame(frame(['----------------------------------------------------------------------------------------------------',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '|   ###      ###       ######       ##        ##          ######    ##       ###    ###      ###   |',
                                  '|   ####    ####      ##    ##      ##      ##         ###          ##      ####    ####    ####   |',
                                  '|   ## ##  ## ##     ##      ##     ##    ##         ###            ##     ## ##    ## ##  ## ##   |',
                                  '|   ##   ##   ##    ##        ##    ##  ##          ##              ##    ##  ##    ##   ##   ##   |',
                                  '|   ##        ##    ############    ####            ##              ##   ##   ##    ##        ##   |',
                                  '|   ##        ##    ##        ##    ##  ##          ##              ##  ##    ##    ##        ##   |',
                                  '|   ##        ##    ##        ##    ##    ##         ###            ## ##     ##    ##        ##   |',
                                  '|   ##        ##    ##        ##    ##      ##         ###          ####      ##    ##        ##   |',
                                  '|   ##        ##    ##        ##    ##        ##          ######    ###       ##    ##        ##   |',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '|   ############    ##       ###       ######         ########        ########                     |',
                                  '|   ##        ##    ##      ####      ##    ##      ###      ###    ###      ###                   |',
                                  '|   ##        ##    ##     ## ##      ##    ##      ##        ##    ##        ##                   |',
                                  '|   ##        ##    ##    ##  ##      ##    ##      ##        ##    ##        ##                   |',
                                  '|   ##        ##    ##   ##   ##      ##    ##      ##        ##    ###      ###                   |',
                                  '|   ##        ##    ##  ##    ##     ##########     ##        ##    ## #######                     |',
                                  '|   ##        ##    ## ##     ##    ##        ##    ##        ##    ##                             |',
                                  '|   ##        ##    ####      ##    ##        ##    ###      ###    ##                             |',
                                  '|   ##        ##    ###       ##    ##        ##      ########      ##                             |',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '|                                                                                                  |',
                                  '----------------------------------------------------------------------------------------------------']))

    def draw(self):
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|             -@@-             |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    -@@-         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            -@@-     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                   -@@-  |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                   -@@-  |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                   -@@-  |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00        -@@-  |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                   -@@-  |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))

        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                   -@@-  |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))

        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                   -@@-  |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             -@@-    |',
                              '|         ----    ----         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    -@@-         |',
                              '|              ++              |',
                              '|                              |',
                              '--------------------------------']))
        self.add_frame(frame(['--------------------------------',
                              '|                              |',
                              '|              ++              |',
                              '|         ----    ----         |',
                              '|     ----            ----     |',
                              '|   ++                    ++   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   --         00         --   |',
                              '|   --                    --   |',
                              '|   --                    --   |',
                              '|   ++                    ++   |',
                              '|     ----             ----    |',
                              '|         ----    ----         |',
                              '|             -@@-             |',
                              '|                              |',
                              '--------------------------------']))

    def scale(self,factor):
        arr = []
        t = " "*len(self.frames[0].strings[0])*factor
        for l in range(0,len(self.frames[0].strings)*factor):
            arr.append(t)
        cur_frame = frame(arr)
        for i in range(0,len(self.frames)):
            arr = []
            t = " "*len(self.frames[-1].strings[0])*factor
            for l in range(0,len(self.frames[-1].strings)*factor):
                arr.append(t)
            cur_frame = frame(arr)
            for j in range(0,len(self.frames[i].strings)):
                for k in range(0,len(self.frames[i].strings[j])):
                    s = self.frames[i].strings[j][k]
                    for l in range(0,factor):
                        for m in range(0,factor):
                            #s = s[:num] + new_simbol + s[num+1:]
                            cur_frame.strings[factor*j+l] = cur_frame.strings[factor*j+l][:factor*k+m] + s + cur_frame.strings[factor*j+l][factor*k+m+1:]
            self.frames[i]=cur_frame

    def start(self,fps,amp):
        t = 0
        t1=0
        f = 0
        offsets=[]
        lights=[]
        for i in range(0,len(self.frames[0].strings)):
            offsets.append(0.0)
            lights.append(0.0)
        while 1==1:
            for i in range(0,len(self.frames)):
                hue = i/len(self.frames)
                os.system('clear')
                for j in range(0,len(self.frames[0].strings)):
                    hue += j*.0002
                    if f%4==0:
                        offsets[j] = amp*math.sin(t1*.05)*math.sin(t1*.05)      #.06
                        offsets[j] *= j/len(self.frames[0].strings)
                        offsets[j] = int(offsets[j])
                        t1 += 1
                    l = .3 + .5*offsets[j]/amp
                    r = int(colorsys.hls_to_rgb(hue,l,1)[0]*255)
                    g = int(colorsys.hls_to_rgb(hue,l,1)[1]*255)
                    b = int(colorsys.hls_to_rgb(hue,l,1)[2]*255)
                    mult=0.1
                    r1=int(r*mult)
                    g1=int(g*mult)
                    b1=int(b*mult)
                    s = ' '*offsets[j] + fg(r,g,b) + bg(r1,g1,b1) + self.frames[i].strings[j] + fg.rs + bg.rs
                    print(s)
                f += 1
                time.sleep(1/fps)
#=========================================================================================================================
l = loading()
l.draw()
l.scale(4)
l.loop()
l.start(60,30)
